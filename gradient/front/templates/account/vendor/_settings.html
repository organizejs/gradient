{% from "modules/_form_fields.html" import render_field_with_errors, render_field %}

<div id="settings-module" class="content-pane">
  <div class="module">
    <div class="module-content">
      <div class="account-content-title"><h4>Stripe Keys</h4></div>
      <div class="account-content-options">
      </div>
    </div>
    <div class="module-content">
      {% if current_user.account.stripe_sk %} 
      <div class="account-property">
        <div class="account-property-label">Stripe Secret Key</div>
        <div class="account-property-value-container">
          <div class="account-property-value">
            {{ current_user.account.stripe_sk }} 
          </div>
        </div>
      </div>
      <div class="account-property">
        <div class="account-property-label">Stripe Public Key</div>
        <div class="account-property-value-container">
          <div class="account-property-value">
            {{ current_user.account.stripe_pk }} 
          </div>
        </div>
      </div>
      <div class="account-footer">
        <div class="account-action">
          <a href="{{ url_for('vendor.reset_stripe_keys') }}">
            <div class="account-button">Reset Stripe Keys</div>
          </a>
        </div>
      </div>
      {% else %}
      <form action="{{ url_for('vendor.stripe_keys') }}" method="POST" name="stripe_keys_form">
        {{ stripe_keys_form.hidden_tag() }}
        {{ render_field_with_errors(stripe_keys_form.stripe_sk) }}
        {{ render_field_with_errors(stripe_keys_form.stripe_pk) }}
        <br>
        <input type="submit" value="Submit">
      </form>
      {% endif %}
    </div>
  </div>
  <div class="module">
    <div class="module-content">
      <div class="account-content-title"><h4>Redirect URL</h4></div>
      <div class="account-content-options">
      </div>
    </div>
    <div class="module-content">
      {% if current_user.account.redirect_url%} 
      <div class="account-property">
        <div class="account-property-label">Redirect Url</div>
        <div class="account-property-value-container">
          <div class="account-property-value">
            {{ current_user.account.redirect_url }} 
          </div>
        </div>
      </div>
      <div class="account-footer">
        <div class="account-action">
          <a href="{{ url_for('vendor.reset_redirect_url') }}">
            <div class="account-button">Reset Redirect Url</div>
          </a>
        </div>
      </div>
      {% else %}
      <form action="{{ url_for('vendor.redirect_url') }}" method="POST" name="redirect_url_form">
        {{ redirect_url_form.hidden_tag() }}
        {{ render_field_with_errors(redirect_url_form.redirect_url) }}
        <br>
        <input type="submit" value="Submit">
      </form>
      {% endif %}
    </div>
  </div>
  <div class="module">
      <div class="module-content">
        <div class="account-content-title"><h4>Settings</h4></div>
        <div class="account-content-options">
        </div>
      </div>
      <div class="module-content">
        <div class="account-property">
          <div class="account-property-label">Subscribed to Newsletter</div>
          <div class="account-property-value-container">
            <div class="account-property-value">
              {% if current_user.subscribe == True %}
              Subscribed
              {% else %}
              Not Subscribed
              {% endif %}
            </div>
          </div>
        </div>
        <div class="account-footer">
          <div class="account-action">
            <!-- TODO - switch 'customer' to 'vendor' or 'user' -->
            {% if current_user.subscribed == True %}
            <a href="{{ url_for('customer.subscribe', subscribe=False) }}">
              <div class="account-button">Unsubscribe</div>
            </a>
            {% else %}
            <a href="{{ url_for('customer.subscribe', subscribe=True) }}">
              <div class="account-button">Subscribe</div>
            </a>
            {% endif %}
          </div>
        </div>
      </div>
  </div>

</div>


